# `generics`

**Applies to:** <Badge text="structs"/> <Badge text="functions"/> <Badge text="methods"/>

::: warning ðŸ”¬ Experimental

This attribute is experimental and requires the `experimental-generics-setters` cargo feature to be enabled. The API may change in minor releases.

:::

Generates methods on the builder for converting generic type parameters to different types. This is useful when building up values with different types at different stages of construction.

**Syntax:**

```attr
#[builder(generics(setters(...)))]
```

## `setters`

Configures the generic parameter conversion methods.

**Short syntax** configures just the name pattern:

```attr
#[builder(generics(setters = "conv_{}"))]
```

**Long syntax** provides more flexibility. The `name` parameter is required, while others are optional:

```attr
#[builder(
    generics(setters(
        name = "conv_{}",
        vis = "pub(crate)",
        doc {
            /// Custom documentation
        }
    ))
)]
```

### `name`

**Required.** A pattern string where `{}` will be replaced with the snake_case name of each generic parameter. For example, with generic parameters `<TData, TError>` and pattern `"with_{}"`, methods `with_t_data()` and `with_t_error()` will be generated.

### `vis`

The visibility for the generated conversion methods. Must be enclosed with quotes. Use `""` or [`"pub(self)"`](https://doc.rust-lang.org/reference/visibility-and-privacy.html#pubin-path-pubcrate-pubsuper-and-pubself) for private visibility.

The default visibility matches the visibility of the [`builder_type`](./builder_type#vis).

### `doc`

Custom documentation for the generated conversion methods. The syntax expects a block with doc comments:

```attr
doc {
    /// Custom documentation
}
```

Simple documentation is generated by default explaining what the method does.

## How It Works

For each generic type parameter (not lifetimes or const generics), a conversion method is generated that:

1. Takes the current builder and returns a new builder with the type parameter changed
2. Preserves all fields that don't use the converted generic parameter

This allows you to start with placeholder types (like `()`) and convert them to concrete types as you build.

## Example

::: code-group

```rust [Basic]
use bon::Builder;

#[derive(Builder)]
#[builder(generics(setters = "with_{}"))] // [!code highlight]
struct Container<TData, TError> {
    data: TData,
    error: TError,
    count: u32,
}

// Start with unit types, then convert to concrete types
let container = Container::<(), ()>::builder()
    .count(42)
    .with_t_data::<i32>()      // Convert TData from () to i32  // [!code highlight]
    .data(100)
    .with_t_error::<&str>()    // Convert TError from () to &str // [!code highlight]
    .error("error message")
    .build();

assert_eq!(container.data, 100);
assert_eq!(container.error, "error message");
assert_eq!(container.count, 42);
```

```rust [Custom Methods]
use bon::Builder;

#[derive(Builder)]
#[builder(generics(setters = "conv_{}"))] // [!code highlight]
struct Data<T> {
    value: T,
}

// Use the generated conversion method to implement custom logic
impl<T1, S: data_builder::State> DataBuilder<T1, S> {
    fn convert_and_set<T2>(
        self,
        value: T2
    ) -> DataBuilder<T2, data_builder::SetValue<S>>
    where
        S::Value: data_builder::IsUnset,
    {
        self.conv_t().value(value) // [!code highlight]
    }
}

let data = Data::<()>::builder()
    .convert_and_set(42)
    .build();

assert_eq!(data.value, 42);
```

:::

## Use Cases

This feature is particularly useful for:

- **Type-level state machines**: Starting with marker types and converting them as you progress through states
- **Builder patterns with type parameters**: When you need to build complex generic structs step-by-step
- **API design**: Allowing users to specify types incrementally rather than all at once

## See Also

- [Typestate API](../../../guide/typestate-api) - Understanding the builder's type system
- [`builder_type`](./builder_type) - Configuring the builder type itself
